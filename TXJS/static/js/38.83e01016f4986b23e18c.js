webpackJsonp([38],{n6Em:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=s("fxnj"),i=s.n(n),o=location.href.split("#")[0],a={name:"organization",mixins:[{data:function(){return{center:[],lists:[]}},methods:{getLocation:function(){var t=this;this.$http.get("/third/jssdk/get-sign-package",{params:{url:o,APIs:["checkJsApi","getLocation"]}}).then(function(t){i.a.config(t.data.info)}),i.a.error(function(t){alert("出错了："+t.errMsg)}),i.a.ready(function(){i.a.checkJsApi({jsApiList:["getLocation"],success:function(t){}}),i.a.getLocation({type:"gcj02",success:function(e){t.center=[e.longitude,e.latitude],t.$http.get("/mechanism",{params:{distance:5e3,latitude:e.latitude,longitude:e.longitude}}).then(function(e){"success"==e.status&&(t.lists=[],e.data.mechanisms.forEach(function(e){var s={};s.position=[e.longitude,e.latitude],s.events={click:function(){t.showMess(e)}},t.lists.push(s)}))})}})})}},created:function(){this.getLocation()}}],data:function(){var t=this;return{org:{name:"",cover:"",tel:"",address:"",business:[],id:""},mess:!1,icon:"//t-oss01.mion.cn/uploads/0b1e08d6a0fd14085c8ac45ecc11c3bd.png",center:[113.3245904,23.1066805],lng:0,lat:0,loaded:!1,plugin:[{enableHighAccuracy:!0,timeout:100,maximumAge:0,convert:!0,showButton:!0,buttonPosition:"RB",showMarker:!0,showCircle:!0,panToLocation:!0,zoomToAccuracy:!0,extensions:"all",pName:"Geolocation",events:{init:function(e){e.getCurrentPosition(function(e,s){s&&s.position&&(t.lng=s.position.lng,t.lat=s.position.lat,t.center=[t.lng,t.lat],t.loaded=!0,t.$nextTick())})},complete:function(e){t.getMechanisms(e.position.lng,e.position.lat)},error:function(t){alert(t.message)}}}],events:{click:function(){t.mess=!1}}}},methods:{showMess:function(t){this.mess=!0,this.org.id=t.id,this.org.cover=t.cover,this.org.tel=t.telephone,this.org.address=t.address,this.org.name=t.name,this.org.business=t.bunisness},getMechanisms:function(t,e){var s=this;this.$http.get("/mechanism",{params:{distance:5e3,latitude:e,longitude:t}}).then(function(t){if("success"===t.status){s.lists=[];var e=s;t.data.mechanisms.forEach(function(t){var n={};n.position=[t.longitude,t.latitude],n.events={click:function(){e.showMess(t)}},s.lists.push(n)})}})}}},c={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("main",{staticClass:"organization"},[s("router-link",{directives:[{name:"show",rawName:"v-show",value:t.mess,expression:"mess"}],staticClass:"mess",attrs:{tag:"div",to:{path:"/organization/detail/"+t.org.id}}},[s("div",{staticClass:"img"},[s("img",{directives:[{name:"lazy",rawName:"v-lazy",value:t.org.cover,expression:"org.cover"}]})]),t._v(" "),s("div",{staticClass:"text"},[s("h3",[t._v(t._s(t.org.name))]),t._v(" "),s("h5",[s("i",{staticClass:"icon-tabbar_icon_tel_selected"}),t._v(t._s(t.org.tel))]),t._v(" "),s("h5",[s("i",{staticClass:"icon-tabbar_icon_address_selected"}),t._v(t._s(t.org.address))]),t._v(" "),s("p",t._l(t.org.business,function(e,n){return s("span",{key:n},[t._v(t._s(e))])}))])]),t._v(" "),t.center.length?s("el-amap",{attrs:{vid:"amap",center:t.center,zoom:18,events:t.events}},[s("el-amap-marker",{attrs:{position:t.center}}),t._v(" "),t._l(t.lists,function(e,n){return s("el-amap-marker",{key:n,attrs:{position:e.position,offset:[-29,-72],events:e.events,visible:!0,draggable:!1,icon:t.icon}})})],2):t._e()],1)},staticRenderFns:[]};var r=s("VU/8")(a,c,!1,function(t){s("yRio")},"data-v-07980502",null);e.default=r.exports},yRio:function(t,e){}});
//# sourceMappingURL=38.83e01016f4986b23e18c.js.map